/**
 * Created by Fomichev Yuri on 21.05.2019
 * Contact me at : toki.stamp@gmail.com
 */

(function () {
    var body = $('<table>', {
        'class': 'table table-condensed table-hover',
        'html' : '<thead><tr><td>Дата<br>обследования</td><td>Вид работ</td><td>Вид<br>обследования</td><td>Исполнитель</td><td>Проверяющий</td><td>Итоговый<br>документ</td><td>Примечания</td><td>Исправлено<br>в pdf</td><td>Агентство</td><td>№<br>заказа</td><td>Статус</td><td>Дата<br>статуса</td></tr><tr><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th><th class="header"></th></tr></thead><tbody id="tbodyForMainTable"><tr id="60261044" data-order-id="60261044" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="1" class="danger selected" data-selectable="1"><td>23.10.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60261044</td><td>Проверил</td><td>08.05.2018</td></tr><tr id="60261044" data-order-id="60261044" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="1" class="danger selected" data-selectable="1"><td>23.10.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60261044</td><td>Проверил</td><td>08.05.2018</td></tr><tr id="60261044" data-order-id="60261044" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="1" class="danger selected" data-selectable="1"><td>23.10.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60261044</td><td>Проверил</td><td>08.05.2018</td></tr><tr id="60261044" data-order-id="60261044" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="1" class="danger selected" data-selectable="1"><td>23.10.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60261044</td><td>Проверил</td><td>08.05.2018</td></tr><tr id="60261044" data-order-id="60261044" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="1" class="danger selected" data-selectable="1"><td>23.10.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60261044</td><td>Проверил</td><td>08.05.2018</td></tr><tr id="60261044" data-order-id="60261044" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="1" class="danger selected" data-selectable="1"><td>23.10.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60261044</td><td>Проверил</td><td>08.05.2018</td></tr><tr id="60261044" data-order-id="60261044" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="1" class="danger selected" data-selectable="1"><td>23.10.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60261044</td><td>Проверил</td><td>08.05.2018</td></tr><tr id="60261044" data-order-id="60261044" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="1" class="danger selected" data-selectable="1"><td>23.10.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60261044</td><td>Проверил</td><td>08.05.2018</td></tr><tr id="60239025" data-order-id="60239025" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>17.01.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Власова М.С.</td><td>Никифоровская Ж.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60239025</td><td>Проверил</td><td>17.01.2018</td></tr><tr id="60229612" data-order-id="60229612" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>14.09.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Иванова С.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60229612</td><td>Проверил</td><td>13.11.2017</td></tr><tr id="60229294" data-order-id="60229294" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>22.08.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Полное обследование</td><td>Антонова О.А.</td><td>Карпович С.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60229294</td><td>Проверил</td><td>10.11.2017</td></tr><tr id="60223509" data-order-id="60223509" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>18.07.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Иванова Д.Н.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60223509</td><td>Проверил</td><td>02.10.2017</td></tr><tr id="60218640" data-order-id="60218640" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>05.01.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Иванова Д.Н.</td><td>Карпович С.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60218640</td><td>Проверил</td><td>29.08.2017</td></tr><tr id="60216376" data-order-id="60216376" data-completed="1" data-operationsname="Проверка характеристик" data-operationtypeid="104" data-latest="0" class="danger" data-selectable="1"><td>не указано</td><td>Проверка характеристик</td><td>не указано</td><td>Семёнова С.В.</td><td>Лейкина Г.А.</td><td>не формировался</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60216376</td><td>Проверил</td><td>22.09.2017</td></tr><tr id="60202483" data-order-id="60202483" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>09.03.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Лебедева Н.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Да</td><td>200</td><td>60202483</td><td>Проверил</td><td>18.05.2017</td></tr><tr id="60200936" data-order-id="60200936" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>01.09.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Власова М.С.</td><td>Никифоровская Ж.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60200936</td><td>Проверил</td><td>10.05.2017</td></tr><tr id="60199367" data-order-id="60199367" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>20.12.2016</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Васильева Д.М.</td><td>Никифоровская Ж.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60199367</td><td>Проверил</td><td>03.05.2017</td></tr><tr id="60191688" data-order-id="60191688" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>24.11.2016</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Полное обследование</td><td>Семёнова С.В.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60191688</td><td>Проверил</td><td>02.03.2017</td></tr><tr id="60190013" data-order-id="60190013" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>19.01.2017</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Макаренко Т.Г.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60190013</td><td>Проверил</td><td>17.02.2017</td></tr><tr id="60188104" data-order-id="60188104" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>22.11.2016</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Полное обследование</td><td>Тутова А.В.</td><td>Никифоровская Ж.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60188104</td><td>Проверил</td><td>08.02.2017</td></tr><tr id="60184445" data-order-id="60184445" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>15.11.2016</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Полное обследование</td><td>Романенко Е.Ю.</td><td>Орлова С.Н.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60184445</td><td>Проверил</td><td>19.01.2017</td></tr><tr id="60174392" data-order-id="60174392" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>22.09.2016</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Полное обследование</td><td>Колодинская А.С.</td><td>Лейкина Г.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60174392</td><td>Проверил</td><td>24.11.2016</td></tr><tr id="60160391" data-order-id="60160391" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>01.07.2014</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Полное обследование</td><td>Антонова О.А.</td><td>Никифоровская Ж.А.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60160391</td><td>Проверил</td><td>04.10.2016</td></tr><tr id="60136540" data-order-id="60136540" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>03.06.2016</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Ципорина Л.Р.</td><td>Лущицкая Л.В.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60136540</td><td>Проверил</td><td>23.06.2016</td></tr><tr id="60135997" data-order-id="60135997" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>24.03.2016</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Обследование части</td><td>Лейкина Г.А.</td><td>Орлова С.Н.</td><td>техпаспорт</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60135997</td><td>Проверил</td><td>22.06.2016</td></tr><tr id="60091550" data-order-id="60091550" data-completed="1" data-operationsname="Первоначальное формирование" data-operationtypeid="101" data-latest="0" class="danger" data-selectable="1"><td>не указано</td><td>Первоначальное формирование</td><td>не указано</td><td>Ципорина Л.Р.</td><td>Лущицкая Л.В.</td><td>не формировался</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60091550</td><td>Проверил</td><td>22.09.2017</td></tr><tr id="60065707" data-order-id="60065707" data-completed="1" data-operationsname="Составление технического паспорта (ведомости технических характеристик) без обследования" data-operationtypeid="107" data-latest="0" class="danger" data-selectable="1"><td>07.12.2015</td><td>Составление технического паспорта (ведомости технических характеристик) без обследования</td><td>Полное обследование</td><td>Семёнова С.В.</td><td>Лущицкая Л.В.</td><td>не формировался</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60065707</td><td>Проверил</td><td>22.09.2017</td></tr><tr id="60248266" data-order-id="60248266" data-completed="0" data-operationsname="Первоначальное формирование" data-operationtypeid="101" data-latest="0" data-selectable="0" class="unable"><td>не указано</td><td>Первоначальное формирование</td><td>не указано</td><td>Лейкина Г.А.</td><td>Лущицкая Л.В.</td><td>не формировался</td><td><div class="forNote" title=""></div></td><td>Нет</td><td>200</td><td>60248266</td><td>На исполнении</td><td>04.04.2016</td></tr></tbody>'
    });

    $('.rh-container')
        .find('section')
        .find('button')
        .on('click', function () {
            (function when() {
                var deferred = jQuery.Deferred();
                var dialog = window['rh_utils'].dialog.getInstance();

                dialog
                    .title('Step 1')
                    .body(body)
                    .button({
                        type : 'close',
                        text : 'Отмена',
                        click: {
                            handler: function () {
                                console.error('ОТМЕНА!', arguments);
                            },
                            args   : ['1', 2, {3: true}, [4]],
                        }
                    })
                    .button({
                        type : 'success',
                        click: {
                            handler: function () {
                                deferred.resolve({'step-1': dialog});
                            }
                        },
                        text : 'Next Step'
                    })
                    // .config({height: {value: 80, unit: 'vh'}, width: {value: 90, unit: '%'}})
                    // .config({height: {value: 80, unit: 'vh'}})
                    // .config({width: {value: 90, unit: '%'}})
                    .show();

                return deferred.promise();
            })()
                .then(function (transport) {
                    var deferred = jQuery.Deferred();
                    var dialog = window['rh_utils'].dialog.getInstance();

                    dialog
                        .title('Step 2')
                        .body('Body for step 2<br>Body for step 2<br>Body for step 2<br>Body for step 2<br>Body for step 2<br>Body for step 2')
                        .button({
                            type : 'success',
                            click: {
                                handler: function () {
                                    transport['step-2'] = dialog;
                                    deferred.resolve(transport);
                                }
                            },
                            text : 'Continue'
                        })
                        .show();

                    return deferred.promise();
                })
                .then(function (transport) {
                    var deferred = jQuery.Deferred();
                    var dialog = window['rh_utils'].dialog.getInstance();

                    dialog
                        .title('Step 3')
                        .body(body)
                        .button({
                            type : 'warning',
                            click: {
                                handler: function () {
                                    transport['step-3'] = dialog;
                                    deferred.resolve(transport);
                                }
                            },
                            text : 'Finish'
                        })
                        .show();

                    return deferred.promise();
                })
                .done(function (transport) {
                    var key;

                    for (key in transport) {
                        if (transport.hasOwnProperty(key)) {
                            console.log(key);
                            transport[key].info.call();
                        }
                    }

                    if (confirm('Reload?')) {
                        window.location.reload();
                    }
                })
                .fail(function (error) {
                    alert(error);
                });
        });
})();